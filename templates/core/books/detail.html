{% extends 'core/base.html' %}
{% load static %}
{% load core_extras %}

{% block title %}{{ book.title }} - Book Friend{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="row">
        <!-- Book Cover Image -->
        <div class="col-md-4 mb-4">
            <div class="card">
                {% if book.cover_image %}
                    <img src="{{ book.cover_image.url }}" class="card-img-top" alt="{{ book.title }} Cover"
                         style="height: 400px; object-fit: cover;">
                {% else %}
                    <img src="{% static 'core/images/default_book.png' %}" class="card-img-top" alt="Default Book Cover"
                         style="height: 400px; object-fit: cover;">
                {% endif %}
            </div>
        </div>

        <!-- Book Details -->
        <div class="col-md-8">
            <h1 class="mb-3">{{ book.title }}</h1>
            <div class="mb-4">
                <p class="mb-2"><strong>Author:</strong> {{ book.author }}</p>
                <p class="mb-2"><strong>Genre:</strong> {{ book.genre }}</p>
                <p class="mb-2">
                    <strong>Owner:</strong> 
                    <a href="{% url 'core:profile' username=book.owner.username %}" class="text-decoration-none text-primary">
                        {{ book.owner.get_full_name }}
                    </a>
                </p>
                <p class="mb-2"><strong>Status:</strong> {% if book.is_available %}Available{% else %}Not Available{% endif %}</p>
            </div>

            <div class="mb-4">
                <h3>Description</h3>
                <p>{{ book.description }}</p>
            </div>

            {% if book.is_available and book.owner != user %}
                <div class="mb-4">
                    <a href="{% url 'core:book_request' book.id %}" class="btn btn-primary">
                        <i class="bi bi-book"></i> Request Book
                    </a>
                </div>
            {% endif %}

            {% if book.owner == user %}
                <div class="mb-4">
                    <a href="{% url 'core:book_edit' book.id %}" class="btn btn-outline-primary me-2">
                        <i class="bi bi-pencil"></i> Edit Book
                    </a>
                    <form method="post" action="{% url 'core:book_delete' book.id %}" class="d-inline" 
                          onsubmit="return confirm('Are you sure you want to delete this book?');">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-outline-danger">
                            <i class="bi bi-trash"></i> Delete Book
                        </button>
                    </form>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}